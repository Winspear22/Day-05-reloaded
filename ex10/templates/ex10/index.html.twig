{% extends 'base.html.twig' %}

{% block title %}Ex10 ‚Äì SQL & ORM{% endblock %}

{% block content %}
    <h1>Ex10 ‚Äì Lecture de fichier et insertion SQL & ORM</h1>

    <div class="form-wrapper">
        <h2>Ins√©rer une donn√©e SQL</h2>
        {{ form_start(formSQL, {'action': path('ex10_insert_data_sql'), 'method': 'POST'}) }}
            {{ form_widget(formSQL) }}
            <button type="submit">Ins√©rer en SQL</button>
        {{ form_end(formSQL) }}

        <h2>Ins√©rer une donn√©e ORM</h2>
        {{ form_start(formORM, {'action': path('ex10_insert_data_orm'), 'method': 'POST'}) }}
            {{ form_widget(formORM) }}
            <button type="submit">Ins√©rer en ORM</button>
        {{ form_end(formORM) }}
    </div>

    <h2>Actions globales</h2>
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
        <form action="{{ path('ex10_import_file') }}" method="post">
            <button type="submit" onclick="return confirm('Importer les donn√©es du fichier text.txt ?')">
                üì• Importer depuis text.txt
            </button>
        </form>
        <form action="{{ path('ex10_delete_all') }}" method="post">
            <button type="submit" onclick="return confirm('Supprimer TOUS les enregistrements SQL ET ORM ?')">
                üóëÔ∏è Supprimer tout (SQL + ORM)
            </button>
        </form>
    </div>

    <hr>

    <h2>Donn√©es existantes (SQL) - ex10_data_sql</h2>
    {% if datasSQL is not empty %}
        <div style="margin-bottom: 10px;">
            <form action="{{ path('ex10_delete_all_data_sql') }}" method="post" style="display:inline;">
                <button type="submit" onclick="return confirm('Supprimer TOUS les enregistrements SQL ?')">
                    üóëÔ∏è Supprimer tous les SQL
                </button>
            </form>
        </div>
        <table border="1" style="width: 100%; margin-top: 20px;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Donn√©es</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for data in datasSQL %}
                    <tr>
                        <td>{{ data.id }}</td>
                        <td>{{ data.data }}</td>
                        <td>{{ data.date }}</td>
                        <td>
                            <form action="{{ path('ex10_delete_data_sql', {id: data.id}) }}" method="post" style="display:inline;">
                                <button type="submit" onclick="return confirm('Supprimer cet enregistrement SQL ?')">
                                    ‚ùå
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p><em>Aucune donn√©e SQL trouv√©e.</em></p>
    {% endif %}

    <h2>Donn√©es existantes (ORM) - ex10_data_orm</h2>
    {% if datasORM is not empty %}
        <div style="margin-bottom: 10px;">
            <form action="{{ path('ex10_delete_all_data_orm') }}" method="post" style="display:inline;">
                <button type="submit" onclick="return confirm('Supprimer TOUS les enregistrements ORM ?')">
                    üóëÔ∏è Supprimer tous les ORM
                </button>
            </form>
        </div>
        <table border="1" style="width: 100%; margin-top: 20px;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Donn√©es</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for data in datasORM %}
                    <tr>
                        <td>{{ data.id }}</td>
                        <td>{{ data.data }}</td>
                        <td>{{ data.date|date('Y-m-d H:i:s') }}</td>
                        <td>
                            <form action="{{ path('ex10_delete_data_orm', {id: data.id}) }}" method="post" style="display:inline;">
                                <button type="submit" onclick="return confirm('Supprimer cet enregistrement ORM ?')">
                                    ‚ùå
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p><em>Aucune donn√©e ORM trouv√©e.</em></p>
    {% endif %}
{% endblock %}
